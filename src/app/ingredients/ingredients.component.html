<!-- Toaster -->
<div *ngIf="showToast" class="toast toast--{{toastType}}">
  <span *ngIf="toastType === 'success'" class="toast__icon">✔</span>
  <p>{{ toastMessage }}</p>
</div>

<!-- HEADER -->
<header class="app-header" [class.app-header--scrolled]="isScrolled">
  <div class="header__inner container">
    <a routerLink="/" class="header__logo-link">
      <svg class="header__logo-icon" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M12 1.5c-3.03 0-5.5 2.47-5.5 5.5v3h-3a1 1 0 00-1 1v3a1 1 0 001 1h18a1 1 0 001-1v-3a1 1 0 00-1-1h-3v-3c0-3.03-2.47-5.5-5.5-5.5zM12 4.5c1.93 0 3.5 1.57 3.5 3.5v3H8.5v-3c0-1.93 1.57-3.5 3.5-3.5z" />
      </svg>
      <span class="header__logo-text">ChefKit</span>
    </a>
    <div class="header__actions">
      <ng-container *ngIf="authService.isLoggedIn()">
        <a *ngIf="authService.currentUser()?.role === 'admin'" routerLink="/admin"
          class="button button--secondary">Admin</a>
        <a routerLink="/" class="button button--primary">Retour</a>
        <button (click)="logout()" class="button button--primary header__nav-link--alt">
          Se déconnecter
        </button>
      </ng-container>
    </div>
  </div>
</header>


<div class="page-container">
  <!-- TITRE PRINCIPAL DE LA PAGE -->
  <h1 class="main-page-title">Sélectionnez les ingrédients que vous avez !</h1>

  <div class="accordion-container">
    <!-- Fruits -->
    <div class="accordion-item" [class.open]="accordionState['fruits']">
      <div class="accordion-header fruits" (click)="toggleAccordion('fruits')">
        <div class="background"></div>
        <h2 class="category-title">Fruits</h2>
        <span class="accordion-icon"></span>
      </div>
      <div class="accordion-content">
        <div class="ingredients-list">
          <button *ngFor="let fruit of fruits" class="ingredient-button"
            [class.selected]="isSelected(fruit.nomIngredient)" (click)="toggleIngredient(fruit.nomIngredient)">
            {{ fruit.nomIngredient }}
          </button>
        </div>
      </div>
    </div>

    <!-- Légumes -->
    <div class="accordion-item" [class.open]="accordionState['legumes']">
      <div class="accordion-header legumes" (click)="toggleAccordion('legumes')">
        <div class="background"></div>
        <h2 class="category-title">Légumes</h2>
        <span class="accordion-icon"></span>
      </div>
      <div class="accordion-content">
        <div class="ingredients-list">
          <button *ngFor="let legume of legumes" class="ingredient-button"
            [class.selected]="isSelected(legume.nomIngredient)" (click)="toggleIngredient(legume.nomIngredient)">
            {{ legume.nomIngredient }}
          </button>
        </div>
      </div>
    </div>

    <!-- Autres -->
    <div class="accordion-item" [class.open]="accordionState['autres']">
      <div class="accordion-header autres" (click)="toggleAccordion('autres')">
        <div class="background"></div>
        <h2 class="category-title">Autres</h2>
        <span class="accordion-icon"></span>
      </div>
      <div class="accordion-content">
        <div class="ingredients-list">
          <button *ngFor="let autre of autres" class="ingredient-button"
            [class.selected]="isSelected(autre.nomIngredient)" (click)="toggleIngredient(autre.nomIngredient)">
            {{ autre.nomIngredient }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- NOUVEAU BOUTON : Sauvegarder les ingrédients -->
  <button class="button button--primary" style="margin-top: var(--spacing-xl); width: auto;"
    (click)="saveSelectedIngredients()">
    Sauvegarder les ingrédients sélectionnés
  </button>
</div>