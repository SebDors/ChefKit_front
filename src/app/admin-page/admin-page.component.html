<!-- HEADER -->
<header class="app-header" [class.app-header--scrolled]="isScrolled">
  <div class="header__inner container">
    <a routerLink="/" class="header__logo-link">
      <svg class="header__logo-icon" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M12 1.5c-3.03 0-5.5 2.47-5.5 5.5v3h-3a1 1 0 00-1 1v3a1 1 0 001 1h18a1 1 0 001-1v-3a1 1 0 00-1-1h-3v-3c0-3.03-2.47-5.5-5.5-5.5zM12 4.5c1.93 0 3.5 1.57 3.5 3.5v3H8.5v-3c0-1.93 1.57-3.5 3.5-3.5z" />
      </svg>
      <span class="header__logo-text">ChefKit</span>
    </a>
    <div class="header__actions">
      <ng-container *ngIf="authService.isLoggedIn()">
        <a routerLink="/ingredient" class="button button--secondary">Mes ingrédients</a>
        <a routerLink="/" class="button button--primary">Retour</a>
        <button (click)="logout()" class="button button--primary header__nav-link--alt">
          Se déconnecter
        </button>
      </ng-container>
    </div>
  </div>
</header>

<!-- MAIN CONTENT -->
<main class="admin-main">
  <section class="admin-hero">
    <div class="admin-hero__content container">
      <h1 class="section-title admin-hero__title">Tableau de Bord Administrateur</h1>
      <div class="stats-grid">
        <div class="stat-card">
          <h3 class="stat-card__title">Utilisateurs</h3>
          <p class="stat-card__number">{{ usersCount }}</p>
        </div>
        <div class="stat-card">
          <h3 class="stat-card__title">Recettes</h3>
          <p class="stat-card__number">{{ recettesCount }}</p>
        </div>
        <div class="stat-card">
          <h3 class="stat-card__title">Ingrédients</h3>
          <p class="stat-card__number">{{ ingredientsCount }}</p>
        </div>
      </div>
    </div>
  </section>

  <div class="container">
    <div class="admin-dashboard-layout">
      <!-- Navigation latérale -->
      <nav class="admin-sidebar">
        <button class="admin-sidebar__item" [class.admin-sidebar__item--active]="activeSection === 'users'"
          (click)="setActiveSection('users')">
          Gérer les Utilisateurs
        </button>
        <button class="admin-sidebar__item" [class.admin-sidebar__item--active]="activeSection === 'recettes'"
          (click)="setActiveSection('recettes')">
          Gérer les Recettes
        </button>
        <button class="admin-sidebar__item" [class.admin-sidebar__item--active]="activeSection === 'ingredients'"
          (click)="setActiveSection('ingredients')">
          Gérer les Ingrédients
        </button>
      </nav>

      <!-- Contenu principal des sections CRUD -->
      <div class="admin-content">
        <!-- USERS -->
        <div class="admin-card" *ngIf="activeSection === 'users'">
          <h2 class="admin-card__title">Gérer les Utilisateurs</h2>

          <!-- Section "Voir un utilisateur" - EN HAUT -->
          <div class="admin-view-section">
            <h4>Voir un utilisateur</h4>
            <div class="form-row">
              <input type="text" placeholder="Nom d'utilisateur" [(ngModel)]="readUserModel.username"
                class="form-input">
              <button (click)="getUser()" class="button button--secondary">Voir</button>
            </div>
            <div *ngIf="readUserResult" class="result-box">
              <p><strong>ID:</strong> {{ readUserResult.idUtilisateur}}</p>
              <p><strong>Nom:</strong> {{ readUserResult.nomUtilisateur }}</p>
              <p><strong>Email:</strong> {{ readUserResult.email }}</p>
              <p><strong>Mot de passe:</strong> {{ readUserResult.motDePasse }}</p>
              <p><strong>Rôle:</strong> {{ readUserResult.role }}</p>
            </div>
            <div *ngIf="userError" class="error-message">
              {{ userError }}
            </div>
          </div>

          <!-- Grille des autres opérations - EN DESSOUS -->
          <div class="admin-forms-grid">
            <!-- Formulaire Créer un utilisateur -->
            <div class="form-section">
              <h4>Créer un utilisateur</h4>
              <input type="text" placeholder="Nom d'utilisateur" [(ngModel)]="createUserModel.nomUtilisateur"
                class="form-input">
              <input type="email" placeholder="Email" [(ngModel)]="createUserModel.email" class="form-input">
              <input type="password" placeholder="Mot de passe" [(ngModel)]="createUserModel.motDePasse"
                class="form-input">
              <select [(ngModel)]="createUserModel.role" class="form-input">
                <option value="user">user</option>
                <option value="admin">admin</option>
              </select>
              <button (click)="createUser()" class="button button--primary">Créer</button>
            </div>

            <!-- Formulaire Modifier un utilisateur -->
            <div class="form-section">
              <h4>Modifier un utilisateur</h4>
              <input type="text" placeholder="Nom d'utilisateur à modifier"
                [(ngModel)]="updateUserModel.usernameToUpdate" class="form-input">
              <input type="text" placeholder="Nouveau nom" [(ngModel)]="updateUserModel.nomUtilisateur"
                class="form-input">
              <input type="email" placeholder="Nouvel email" [(ngModel)]="updateUserModel.email" class="form-input">
              <input type="password" placeholder="Nouveau mot de passe" [(ngModel)]="updateUserModel.motDePasse"
                class="form-input">
              <select [(ngModel)]="updateUserModel.role" class="form-input">
                <option value="user">user</option>
                <option value="admin">admin</option>
              </select>
              <button (click)="updateUser()" class="button button--primary">Modifier</button>
            </div>

            <!-- Formulaire Supprimer un utilisateur -->
            <div class="form-section">
              <h4>Supprimer un utilisateur</h4>
              <input type="text" placeholder="Nom d'utilisateur à supprimer" [(ngModel)]="deleteUserModel.username"
                class="form-input">
              <button (click)="deleteUser()" class="button button--danger">Supprimer</button>
            </div>
          </div>
        </div>

        <!-- RECETTES -->
        <div class="admin-card" *ngIf="activeSection === 'recettes'">
          <h2 class="admin-card__title">Gérer les Recettes</h2>

          <!-- Section "Voir une recette" - EN HAUT -->
          <div class="admin-view-section">
            <h4>Voir une recette</h4>
            <div class="form-row">
              <input type="text" placeholder="Titre de la recette" [(ngModel)]="readRecetteModel.titre"
                class="form-input">
              <button (click)="getRecette()" class="button button--secondary">Voir</button>
            </div>
            <div *ngIf="readRecetteResult" class="result-box">
              <p><strong>ID:</strong> {{ readRecetteResult.idRecette }}</p>
              <p><strong>Titre:</strong> {{ readRecetteResult.titre }}</p>
              <p><strong>Description:</strong> {{ readRecetteResult.description }}</p>
              <p><strong>Instructions:</strong> {{ readRecetteResult.instructions }}</p>
              <p><strong>Temps de préparation:</strong> {{ readRecetteResult.tempsPreparationMinutes }} minutes</p>
              <p><strong>Temps de cuisson:</strong> {{ readRecetteResult.tempsCuissonMinutes }} minutes</p>
              <p><strong>Nombre de personnes:</strong> {{ readRecetteResult.nombrePersonnes }}</p>
              <img src="{{ readRecetteResult.pathImage }}" alt="Image de la recette" class="recipe-image">
            </div>
            <div *ngIf="recetteError" class="error-message">
              {{ recetteError }}
            </div>
          </div>

          <!-- Grille des autres opérations - EN DESSOUS -->
          <div class="admin-forms-grid">
            <!-- Formulaire Créer une recette -->
            <div class="form-section">
              <h4>Créer une recette</h4>
              <input type="text" placeholder="Titre" [(ngModel)]="createRecetteModel.titre" class="form-input">
              <input type="text" placeholder="Description" [(ngModel)]="createRecetteModel.description"
                class="form-input">
              <input type="text" placeholder="Instructions" [(ngModel)]="createRecetteModel.instructions"
                class="form-input">
              <input type="number" placeholder="Temps de préparation"
                [(ngModel)]="createRecetteModel.tempsPreparationMinutes" class="form-input">
              <input type="number" placeholder="Temps de cuisson" [(ngModel)]="createRecetteModel.tempsCuissonMinutes"
                class="form-input">
              <input type="number" placeholder="Nombre de personnes" [(ngModel)]="createRecetteModel.nombrePersonnes"
                class="form-input">
              <input type="text" placeholder="Chemin de l'image" [(ngModel)]="createRecetteModel.pathImage"
                class="form-input">
              <button (click)="createRecette()" class="button button--primary">Créer</button>
            </div>

            <!-- Formulaire Modifier une recette -->
            <div class="form-section">
              <h4>Modifier une recette</h4>
              <input type="text" placeholder="Titre à modifier" [(ngModel)]="updateRecetteModel.titleToUpdate"
                class="form-input">
              <input type="text" placeholder="Nouveau titre" [(ngModel)]="updateRecetteModel.titre" class="form-input">
              <input type="text" placeholder="Nouvelle description" [(ngModel)]="updateRecetteModel.description"
                class="form-input">
              <input type="text" placeholder="Nouvelles instructions" [(ngModel)]="updateRecetteModel.instructions"
                class="form-input">
              <input type="number" placeholder="Nouveau temps de préparation"
                [(ngModel)]="updateRecetteModel.tempsPreparationMinutes" class="form-input">
              <input type="number" placeholder="Nouveau temps de cuisson"
                [(ngModel)]="updateRecetteModel.tempsCuissonMinutes" class="form-input">
              <input type="number" placeholder="Nouveau nombre de personnes"
                [(ngModel)]="updateRecetteModel.nombrePersonnes" class="form-input">
              <input type="text" placeholder="Nouveau chemin de l'image" [(ngModel)]="updateRecetteModel.pathImage"
                class="form-input">
              <button (click)="updateRecette()" class="button button--primary">Modifier</button>
            </div>

            <!-- Formulaire Supprimer une recette -->
            <div class="form-section">
              <h4>Supprimer une recette</h4>
              <input type="text" placeholder="Titre à supprimer" [(ngModel)]="deleteRecetteModel.title"
                class="form-input">
              <button (click)="deleteRecette()" class="button button--danger">Supprimer</button>
            </div>
          </div>
        </div>

        <!-- INGRÉDIENTS -->
        <div class="admin-card" *ngIf="activeSection === 'ingredients'">
          <h2 class="admin-card__title">Gérer les Ingrédients</h2>

          <!-- Section "Voir un ingrédient" - EN HAUT -->
          <div class="admin-view-section">
            <h4>Voir un ingrédient</h4>
            <div class="form-row">
              <input type="text" placeholder="Nom de l'ingrédient" [(ngModel)]="readIngredientModel.nom_ingredient"
                class="form-input">
              <button (click)="getIngredient()" class="button button--secondary">Voir</button>
            </div>
            <div *ngIf="readIngredientResult" class="result-box">
              <p><strong>ID:</strong> {{ readIngredientResult.idIngredient }}</p>
              <p><strong>Nom:</strong> {{ readIngredientResult.nomIngredient }}</p>
              <p><strong>Catégorie:</strong> {{ readIngredientResult.categorie }}</p>
            </div>
            <div *ngIf="ingredientError" class="error-message">
              {{ ingredientError }}
            </div>
          </div>

          <!-- Grille des autres opérations - EN DESSOUS -->
          <div class="admin-forms-grid">
            <!-- Formulaire Créer un ingrédient -->
            <div class="form-section">
              <h4>Créer un ingrédient</h4>
              <input type="text" placeholder="Nom de l'ingrédient" [(ngModel)]="createIngredientModel.nomIngredient"
                class="form-input">
              <input type="text" placeholder="Catégorie" [(ngModel)]="createIngredientModel.categorie"
                class="form-input">
              <button (click)="createIngredient()" class="button button--primary">Créer</button>
            </div>

            <!-- Formulaire Modifier un ingrédient -->
            <div class="form-section">
              <h4>Modifier un ingrédient</h4>
              <input type="text" placeholder="Ingrédient à modifier"
                [(ngModel)]="updateIngredientModel.nom_ingredientToUpdate" class="form-input">
              <input type="text" placeholder="Nouveau nom" [(ngModel)]="updateIngredientModel.nomIngredient"
                class="form-input">
              <input type="text" placeholder="Nouvelle catégorie" [(ngModel)]="updateIngredientModel.categorie"
                class="form-input">
              <button (click)="updateIngredient()" class="button button--primary">Modifier</button>
            </div>

            <!-- Formulaire Supprimer un ingrédient -->
            <div class="form-section">
              <h4>Supprimer un ingrédient</h4>
              <input type="text" placeholder="Ingrédient à supprimer" [(ngModel)]="deleteIngredientModel.nom_ingredient"
                class="form-input">
              <button (click)="deleteIngredient()" class="button button--danger">Supprimer</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- FOOTER (inchangé) -->
<footer class="app-footer">
  <div class="footer__inner container">
    <div class="footer__brand">
      <span class="footer__logo-text">ChefKit</span>
      <p class="footer__slogan">Simplifiez votre quotidien.</p>
    </div>
    <nav class="footer__nav">
      <a href="#" class="footer__nav-link">Conditions d'utilisation</a>
      <a href="#" class="footer__nav-link">Politique de confidentialité</a>
    </nav>
    <div class="footer__copyright">
      &copy; {{ currentYear }} ChefKit. Tous droits réservés.
    </div>
  </div>
</footer>