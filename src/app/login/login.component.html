<!-- HEADER: Minimaliste, réutilisé depuis la home-page pour la cohérence -->
<header class="app-header app-header--scrolled">
  <div class="header__inner container">
    <a routerLink="/" class="header__logo-link">
      <svg class="header__logo-icon" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 1.5c-3.03 0-5.5 2.47-5.5 5.5v3h-3a1 1 0 00-1 1v3a1 1 0 001 1h18a1 1 0 001-1v-3a1 1 0 00-1-1h-3v-3c0-3.03-2.47-5.5-5.5-5.5zM12 4.5c1.93 0 3.5 1.57 3.5 3.5v3H8.5v-3c0-1.93 1.57-3.5 3.5-3.5z" />
      </svg>
      <span class="header__logo-text">ChefKit</span>
    </a>
  </div>
</header>

<!-- Conteneur principal qui occupe toute la hauteur -->
<main class="auth-page-container">
  <div class="auth-card">
    <a routerLink="/" class="back-button" aria-label="Retour à la page d'accueil">
      <svg fill="currentColor" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
    </a>

    <h2 class="auth-card__title">Connexion</h2>
    <p class="auth-card__subtitle">Heureux de vous revoir !</p>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="auth-form">
      
      <div class="form-group">
        <label for="nomUtilisateur" class="form-label">Nom d'utilisateur</label>
        <input type="text" id="nomUtilisateur" formControlName="nomUtilisateur" class="form-input" [class.is-invalid]="loginForm.get('nomUtilisateur')?.invalid && loginForm.get('nomUtilisateur')?.touched">
        
        <div *ngIf="loginForm.get('nomUtilisateur')?.invalid && (loginForm.get('nomUtilisateur')?.dirty || loginForm.get('nomUtilisateur')?.touched)" class="error-message">
          <div *ngIf="loginForm.get('nomUtilisateur')?.errors?.['required']">Le nom d'utilisateur est requis.</div>
          <div *ngIf="loginForm.get('nomUtilisateur')?.errors?.['minlength']">Doit contenir au moins 3 caractères.</div>
        </div>
      </div>

      <div class="form-group">
        <label for="password" class="form-label">Mot de passe</label>
        
        <div class="password-wrapper">
          <input
            [type]="passwordVisible() ? 'text' : 'password'"
            id="password"
            formControlName="password"
            class="form-input"
            [class.is-invalid]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched"
          >
          
          <button
            type="button"
            class="toggle-password-btn"
            (click)="togglePasswordVisibility()"
            aria-label="Afficher ou masquer le mot de passe"
          >
            <svg *ngIf="passwordVisible()" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <svg *ngIf="!passwordVisible()" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.01-3.033M6.12 6.12A9.969 9.969 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.953 9.953 0 01-4.243 4.243M3 3l18 18" />
            </svg>
                  </button>
                </div>

                <div *ngIf="loginForm.get('password')?.invalid && (loginForm.get('password')?.dirty || loginForm.get('password')?.touched)" class="error-message">
                  <div *ngIf="loginForm.get('password')?.errors?.['required']">Le mot de passe est requis.</div>
                </div>
              </div>


      <div *ngIf="errorMessage()" class="api-error-message">
        {{ errorMessage() }}
      </div>

      <button type="submit" class="button button--primary auth-form__submit-button" [disabled]="loginForm.invalid || isLoading()">
        <span *ngIf="!isLoading()">Se connecter</span>
        <span *ngIf="isLoading()" class="loading-spinner"></span>
      </button>

      <div class="auth-card__footer">
        Pas encore de compte ? <a routerLink="/register" class="auth-card__link">S'inscrire</a>
      </div>
    </form>
  </div>
</main>
